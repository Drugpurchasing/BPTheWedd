<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡πÄ‡∏ä‡∏¥‡∏ç‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏°‡∏á‡∏Ñ‡∏•‡∏™‡∏°‡∏£‡∏™‡∏Ç‡∏≠‡∏á ‡∏≠‡∏†‡∏†. ‡πÅ‡∏•‡∏∞‡∏ä‡∏ô.</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-color: #0077b6;
            --secondary-color: #90e0ef;
            --bg-color: #f0f8ff;
            --text-color: #333;
            --white: #ffffff;
            --accent-color: #ffb703;
            --container-padding-mobile: 20px;
            --container-padding-desktop: 40px;
        }

        /* Reset ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô */
        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent; /* ‡∏•‡∏ö‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏ï‡∏∞‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
        }

        body { 
            font-family: 'Prompt', sans-serif; 
            background-color: var(--bg-color);
            background-image: linear-gradient(135deg, #f0f8ff 0%, #e1f5fe 100%);
            color: var(--text-color);
            margin: 0;
            /* ‡∏õ‡∏£‡∏±‡∏ö padding ‡∏£‡∏≠‡∏ö‡∏ô‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏ô‡πâ‡∏≠‡∏¢‡∏•‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            padding: 15px 10px; 
            display: flex;
            justify-content: center;
            align-items: center; /* ‡∏à‡∏±‡∏î‡∏Å‡∏∂‡πà‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
            min-height: 100vh;
        }

        .container { 
            width: 100%;
            max-width: 480px; 
            background: var(--white); 
            /* ‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Padding */
            padding: 30px var(--container-padding-mobile); 
            border-radius: 20px; 
            box-shadow: 0 4px 20px rgba(0, 119, 182, 0.1); 
            text-align: center;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        /* --- ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß (Responsive ‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠) --- */
        .header-img {
            /* ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á: 100% + (Padding ‡∏ã‡πâ‡∏≤‡∏¢‡∏Ç‡∏ß‡∏≤ * 2) */
            width: calc(100% + (var(--container-padding-mobile) * 2));
            height: auto;
            /* ‡∏î‡∏∂‡∏á‡∏†‡∏≤‡∏û‡∏Å‡∏•‡∏±‡∏ö‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ‡πÅ‡∏•‡∏∞‡∏≠‡∏≠‡∏Å‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡πâ‡∏≤‡∏á */
            margin: -30px calc(var(--container-padding-mobile) * -1) 20px calc(var(--container-padding-mobile) * -1);
            border: none;
            display: block;
            object-fit: cover;
        }

        h1.main-title { 
            color: var(--primary-color); 
            margin: 0 0 15px 0; 
            font-weight: 600;
            letter-spacing: 0.5px;
            font-size: 1.25rem; /* ‡∏õ‡∏£‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ */
            line-height: 1.4;
        }

        /* --- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà --- */
        .location-box {
            background-color: #f8fbff;
            border: 1px dashed var(--primary-color);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 20px;
        }

        .location-name {
            font-weight: 600;
            color: #333;
            font-size: 0.95rem;
            margin: 0 0 8px 0;
        }

        .map-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            background-color: var(--white);
            color: var(--primary-color);
            text-decoration: none;
            padding: 8px 16px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™ */
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            border: 1px solid var(--primary-color);
            transition: all 0.2s;
        }

        .map-link:active {
            background-color: var(--secondary-color);
            transform: scale(0.98);
        }

        .divider {
            height: 4px;
            width: 50px;
            background-color: var(--secondary-color);
            margin: 0 auto 30px auto;
            border-radius: 2px;
        }

        /* --- Form Styles --- */
        .form-group { margin-bottom: 20px; text-align: left; width: 100%; }
        label { display: block; margin-bottom: 8px; font-weight: 500; color: var(--primary-color); font-size: 1rem; }
        
        /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô iOS Zoom ‡∏î‡πâ‡∏ß‡∏¢ font-size 16px */
        input[type="text"], textarea, select { 
            width: 100%; 
            padding: 12px 15px; 
            border: 2px solid #e0e0e0; 
            border-radius: 12px; 
            font-family: 'Prompt', sans-serif; 
            font-size: 16px; /* ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Mobile */
            background: #fafafa;
            appearance: none; /* ‡∏•‡∏ö style ‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á OS */
            -webkit-appearance: none;
        }
        
        input[type="text"]:focus, textarea:focus { outline: none; border-color: var(--primary-color); background: #fff; }

        .radio-wrapper { display: flex; gap: 10px; justify-content: center; width: 100%; }
        .radio-option { flex: 1; position: relative; display: flex; }
        .radio-option input { position: absolute; opacity: 0; cursor: pointer; width: 100%; height: 100%; z-index: 2; margin: 0; }
        
        .radio-tile {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background-color: #fff; border: 2px solid #e0e0e0; border-radius: 12px;
            padding: 15px 5px; cursor: pointer; transition: all 0.2s ease; width: 100%; 
        }
        /* ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Active (‡∏Å‡∏î‡∏Ñ‡πâ‡∏≤‡∏á) */
        .radio-option input:active + .radio-tile { transform: scale(0.98); background-color: #f0f8ff; }
        .radio-tile span { font-weight: 500; font-size: 0.95rem; }
        
        .radio-option input:checked + .radio-tile { 
            background-color: var(--primary-color); 
            border-color: var(--primary-color); 
            color: white; 
            box-shadow: 0 4px 12px rgba(0, 119, 182, 0.3); 
        }

        #conditional-message { display: none; margin-top: 20px; transition: opacity 0.3s ease; }

        button#submitBtn { 
            background-color: var(--primary-color); color: white; border: none; padding: 15px; 
            border-radius: 12px; cursor: pointer; width: 100%; font-size: 1.1rem; 
            font-weight: 600; font-family: 'Prompt', sans-serif; margin-top: 10px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1); 
            touch-action: manipulation; /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Double tap zoom */
        }
        button#submitBtn:active { transform: scale(0.98); background-color: #023e8a; }

        #statusMessage { margin-top: 20px; font-weight: 500; min-height: 1.2em; }
        .loading { opacity: 0.7; pointer-events: none; }

        /* --- Gallery Buttons (Mobile Optimized) --- */
        .gallery-section {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            display: flex;
            flex-direction: row; /* ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô */
            gap: 10px; 
        }
        
        .gallery-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            background-color: #fff;
            color: #555;
            text-decoration: none;
            font-size: 0.9rem;
            padding: 12px 10px; /* ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏õ‡∏∏‡πà‡∏° */
            border: 1px solid #ddd;
            border-radius: 12px; /* ‡πÇ‡∏Ñ‡πâ‡∏á‡∏°‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏Å‡∏±‡∏ö‡∏ò‡∏µ‡∏° */
            flex: 1; /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡πÄ‡∏ï‡πá‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô */
            transition: all 0.2s;
        }

        .gallery-btn:active {
            background-color: #f0f8ff;
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        /* --- Desktop / Tablet Overrides --- */
        @media (min-width: 481px) {
            body { padding: 30px; }
            .container { 
                padding: 40px var(--container-padding-desktop); 
            }
            .header-img {
                width: calc(100% + (var(--container-padding-desktop) * 2));
                margin: -40px calc(var(--container-padding-desktop) * -1) 25px calc(var(--container-padding-desktop) * -1);
            }
            h1.main-title { font-size: 1.4rem; }
            .gallery-btn:hover {
                transform: translateY(-2px);
                border-color: var(--primary-color);
                color: var(--primary-color);
            }
            button#submitBtn:hover { background-color: #023e8a; }
        }
    </style>
</head>
<body>

<div class="container">
    <img src="https://github.com/Drugpurchasing/BPTheWedd/blob/main/cartoon.png?raw=true" alt="Wedding Logo" class="header-img">

    <h1 class="main-title">‡πÄ‡∏ä‡∏¥‡∏ç‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏°‡∏á‡∏Ñ‡∏•‡∏™‡∏°‡∏£‡∏™‡∏Ç‡∏≠‡∏á ‡∏≠‡∏†‡∏†. ‡πÅ‡∏•‡∏∞‡∏ä‡∏ô. ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ 2569 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</h1>

    <div class="location-box">
        <p class="location-name">üìç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà: ‡∏Ñ‡∏£‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡∏≠‡∏ô‡πÑ‡∏ó‡∏¢</p>
        <a href="https://share.google/kQVwaym8ibyNe1pvb" target="_blank" class="map-link">
            üó∫Ô∏è ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡∏ó‡∏≤‡∏á
        </a>
    </div>

    <div class="divider"></div>

    <form id="rsvpForm">
        <div class="form-group">
            <label for="name">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• (‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤):</label>
            <input type="text" id="name" name="name" list="guestList" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." required autocomplete="off">
            <datalist id="guestList"></datalist>
        </div>

        <div class="form-group">
            <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°:</label>
            <div class="radio-wrapper">
                <div class="radio-option">
                    <input type="radio" id="join" name="status" value="join" required>
                    <label class="radio-tile" for="join">
                        <span>üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°</span>
                    </label>
                </div>
                <div class="radio-option">
                    <input type="radio" id="not_join" name="status" value="not_join">
                    <label class="radio-tile" for="not_join">
                        <span>üôè ‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å</span>
                    </label>
                </div>
            </div>
        </div>

        <div id="conditional-message" class="form-group">
            <label for="message">‡∏ù‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏∂‡∏á‡∏ö‡πà‡∏≤‡∏ß‡∏™‡∏≤‡∏ß (Optional):</label>
            <textarea id="message" name="message" rows="3" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡∏¥‡∏î‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‡∏Ç‡∏≠‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö..."></textarea>
        </div>

        <button type="submit" id="submitBtn">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    </form>
    <p id="statusMessage"></p>

    <div class="gallery-section">
        <a href="https://bpthewedd.pages.dev/Card" target="_blank" class="gallery-btn">
            üíå ‡∏ä‡∏°‡∏Å‡∏≤‡∏£‡πå‡∏î
        </a>
        <a href="https://bpthewedd.pages.dev/" target="_blank" class="gallery-btn">
            ‚ú® ‡∏ä‡∏°‡∏™‡∏¥‡πà‡∏á‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°
        </a>
    </div>
</div>

<script>
    // --- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ URL ‡∏Ç‡∏≠‡∏á Google Apps Script ---
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzSNXz9TK-y7IL6ECJOG_C77Ibz1RY5f5Ewv5p2aAewN1Ic4soxQI77d2ZXgUjU57DT/exec'; 

    const radioJoin = document.getElementById('join');
    const radioNotJoin = document.getElementById('not_join');
    const conditionalMsg = document.getElementById('conditional-message');
    const messageInput = document.getElementById('message');

    function toggleMessageField() {
        if (radioNotJoin.checked) {
            conditionalMsg.style.display = 'block';
            setTimeout(() => { conditionalMsg.style.opacity = '1'; }, 10);
        } else {
            conditionalMsg.style.opacity = '0';
            setTimeout(() => {
                 if (radioJoin.checked) {
                    conditionalMsg.style.display = 'none';
                    messageInput.value = ''; 
                 }
            }, 300);
        }
    }

    radioJoin.addEventListener('change', toggleMessageField);
    radioNotJoin.addEventListener('change', toggleMessageField);
    conditionalMsg.style.opacity = '0';

    // ‡∏î‡∏∂‡∏á‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏Ç‡∏Å
    window.addEventListener('DOMContentLoaded', () => {
        fetch(`${SCRIPT_URL}?action=getGuests`)
            .then(response => response.json())
            .then(data => {
                const dataList = document.getElementById('guestList');
                dataList.innerHTML = '';
                data.forEach(name => {
                    if (name && name.trim() !== '') {
                        const option = document.createElement('option');
                        option.value = name;
                        dataList.appendChild(option);
                    }
                });
            })
            .catch(error => console.error('Error fetching guests:', error));
    });

    // Form Submit
    const form = document.getElementById('rsvpForm');
    const submitBtn = document.getElementById('submitBtn');
    const statusMsg = document.getElementById('statusMessage');

    form.addEventListener('submit', e => {
        e.preventDefault();
        
        submitBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
        submitBtn.disabled = true; 
        form.classList.add('loading');
        statusMsg.style.display = 'none'; 

        const formData = new FormData(form);

        fetch(SCRIPT_URL, {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())
        .then(result => {
            if(result.result === 'success') {
                statusMsg.textContent = "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏±‡∏ö!";
                statusMsg.style.display = 'block';
                statusMsg.style.color = '#0077b6';
                form.reset();
                conditionalMsg.style.opacity = '0';
                setTimeout(() => { conditionalMsg.style.display = 'none'; }, 300);
            } else {
                throw new Error(result.error || JSON.stringify(result));
            }
        })
        .catch(error => {
            statusMsg.textContent = "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á";
            statusMsg.style.display = 'block';
            statusMsg.style.color = '#d32f2f';
            console.error('Error!', error.message);
        })
        .finally(() => {
            submitBtn.textContent = '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            submitBtn.disabled = false;
            form.classList.remove('loading');
        });
    });
</script>

</body>
</html>
